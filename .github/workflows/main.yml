name: 'build and test'
on: [push]

jobs:
  build-wrappers-macos:
    runs-on: macos-latest
    name: 'Build macOs wrappers'
    steps:
    - name: 'Checkout code'
      uses: actions/checkout@v2
      with:
        submodules: recursive
    - name: 'Check if cache contains wrappers already'
      id: wrapper-cache
      uses: actions/cache@v2
      with:
        path: ./wrappers/build/
        key: wrapper-macos-${{hashfiles('./wrappers/**')}}
    - name: 'Build wrappers'
      if: 'steps.wrapper-cache.outputs.cache-hit != true'
      uses: ./.github/actions/build_macos_wrappers
      with:
        build-configuration: Release
