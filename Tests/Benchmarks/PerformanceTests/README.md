# About Synthetic Benchmarks

The Realm .NET SDK uses [Benchmark.NET](http://benchmarkdotnet.org) to run synthetic benchmarks against the database. These are typically not intended to cover every possible scenario, but rather measure the performance of most common operations and provide historical data that will help us uncover performance regressions.

## Running the benchmarks

To run all tests, use `dotnet run -c Release -f net5.0 -- -f *`. To run only a subset of the tests, replace `*` with a regex that will match the tests you want to run. To list all benchmarks, use `dotnet run -c Release -f net5.0 -- --list`. Refer to [the docs](https://benchmarkdotnet.org/articles/guides/console-args.html) for a complete list of the supported arguments.

## Best practices

The .NET Performance project has an [amazing guide](https://github.com/dotnet/performance/blob/master/docs/microbenchmark-design-guidelines.md) on writing quality microbenchmarks (most Realm .NET benchmarks can be qualified as micro-). One area where we don't follow it to the letter is related to the "no side effects" rule. Since we're measuring the performance of a database, that inherently introduces side effects every time we're committing a transaction. So we take the less compelling "try to avoid side effects" stance.

## Historical performance

Benchmarks are run as part of merge commits to master and then uploaded to MongoDB Atlas (see [#2552](https://github.com/realm/realm-dotnet/pull/2552) for details) and then plotted using MongoDB Charts. A dashboard with benchmark runs can be found [here](https://charts.mongodb.com/charts-realm-sdk-metrics-yxjvt/public/dashboards/6115babd-c7fe-47ee-836f-efffd92ffae3).

### Adding new benchmarks

When adding new benchmarks, be sure to download the `dashboard.charts` generated by Github Actions and import it into [Charts](https://charts.mongodb.com/charts-realm-sdk-metrics-yxjvt/dashboards).

## (WIP) Running tests on different platforms

This is still not implemented. Currently, only .NET 5 is supported as a target framework. We would like to run benchmark tests at least on .NET 5 and Xamarin.

